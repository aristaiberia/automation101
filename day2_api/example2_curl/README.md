# Basic curl examples
Basic examples about using curl with EOS and with Cloudvision

## curl with EOS API EXAMPLES

`eos1.sh` shows a curl example calling EOS API to run `show version` in the switch

```
root@control /lab/api/sh # ./eos1.sh | jq
{
  "jsonrpc": "2.0",
  "id": "miid1",
  "result": [
    {
      "memTotal": 1498328,
      "uptime": 120.2,
      "modelName": "vEOS",
      "internalVersion": "4.24.0F-16270098.4240F",
      "mfgName": "",
      "serialNumber": "",
      "systemMacAddress": "50:54:00:00:31:31",
      "bootupTimestamp": 1608199176,
      "memFree": 845052,
      "version": "4.24.0F",
      "configMacAddress": "00:00:00:00:00:00",
      "isIntlVersion": false,
      "internalBuildId": "da8d6269-c25f-4a12-930b-c3c42c12c38a",
      "hardwareRevision": "",
      "hwMacAddress": "00:00:00:00:00:00",
      "architecture": "i686"
    }
  ]
}
```

`eos2.sh` and `eos3.sh` do as well `show version` in the switch, however, this time the authentication is done by using cookies. So `eos2.sh` first calls /login EOS API endpoint passing authentication credentials in the POST body and, if credentials are correct, obtaining an authentication cookie and storing in `cookiefile` file. Later , subsequent calls can use that cookie to authenticate the API call. `eos3.sh` uses cookiefile to authenticate the API call to run `show version` in the switch.

```
root@control /lab/api/sh # ./eos2.sh 
{ "Login" : true }
root@control /lab/api/sh # 
root@control /lab/api/sh # ls
cookiefile  cvp1.sh  cvp2.sh  cvp3.sh  eos1.sh  eos2.sh  eos3.sh
root@control /lab/api/sh # 
root@control /lab/api/sh # cat cookiefile 
# Netscape HTTP Cookie File
# https://curl.haxx.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

#HttpOnly_10.34.0.31	FALSE	/	FALSE	1608286274	Session	2a4604c2-25a3-4c2e-81ea-c4eae9426e26
root@control /lab/api/sh # 
root@control /lab/api/sh # ./eos3.sh | jq
{
  "jsonrpc": "2.0",
  "id": "miid1",
  "result": [
    {
      "memTotal": 1498328,
      "uptime": 730.04,
      "modelName": "vEOS",
      "internalVersion": "4.24.0F-16270098.4240F",
      "mfgName": "",
      "serialNumber": "",
      "systemMacAddress": "50:54:00:00:31:31",
      "bootupTimestamp": 1608199176,
      "memFree": 835488,
      "version": "4.24.0F",
      "configMacAddress": "00:00:00:00:00:00",
      "isIntlVersion": false,
      "internalBuildId": "da8d6269-c25f-4a12-930b-c3c42c12c38a",
      "hardwareRevision": "",
      "hwMacAddress": "00:00:00:00:00:00",
      "architecture": "i686"
    }
  ]
}
```

## curl with CVP API EXAMPLES

`cvp1.sh` can be used to authenticate towards CVP and get an authentication cookie.

```
root@control /lab/api/sh # ./cvp1.sh 
{"sessionId":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJkaWQiOjEzLCJkc24iOiJjdnBhZG1pbiIsImRzdCI6InVzZXIiLCJzaWQiOiI1YzdlY2U2NDcwMTM0YzE3MjcxZmE0YzEyNWU0OTAzYmUxYWZmOTEyMjIyZGU5YTliOWM0MjJkZGEzNTQzMzIyLUloaXljcExDX183ei12...
root@control /lab/api/sh # cat cookiefile 
# Netscape HTTP Cookie File
# https://curl.haxx.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

10.34.0.2	FALSE	/	TRUE	1608286572	access_token	eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJkaWQiOjEzLCJkc24iOiJjdnBhZG1pbiIsImRzdCI6InVzZXIiLCJzaWQiOiI1YzdlY2U2NDcwMTM0YzE3MjcxZmE0YzEyNWU0OTAzYmUxYWZmOTEyMjIyZGU5YTliOWM0MjJkZGEzNTQzMzIyLUloaXljcExDX183ei12
```

Later other CVP API calls can use the authentication cookie to authenticate subsequent CVP API calls like `cvp2.sh` and `cvp3.sh` examples do.

```
root@control /lab/api/sh # ./cvp2.sh 
{"version":"2020.1.0"}
root@control /lab/api/sh # ./cvp3.sh | jq
{
  "total": 1,
  "roles": {
    "cvpadmin": [
      "network-admin"
    ]
  },
  "users": [
    {
      "userId": "cvpadmin",
      "firstName": "",
      "lastName": "",
      "email": "s@dom.local",
      "lastAccessed": 1608200363585,
      "contactNumber": "",
      "userType": "Local",
      "userStatus": "Enabled",
      "currentStatus": "Online",
      "addedByUser": "cvp system"
    }
  ]
}
```
